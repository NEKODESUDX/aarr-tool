<!DOCTYPE html>
<html lang="ja">
<head>
   <meta charset="UTF-8">
   <title>AARR tool</title>
   <meta name="description" content="message tool">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta name="theme-color" content="blue">
   <meta property="og:title" content="AARR tool">
   <meta property="og:description" content="メッセージ送信ツールです">
   <meta property="og:image" content="https://i.imgur.com/rApLvfn.png">
   <link rel="stylesheet" href="style.css">

   <style>
body {
    font-family: Arial, sans-serif;
    background-color: #0f0f0f;
    color: #fff;
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    min-height: 100vh;
}

#app {
    width: 100%;
    background-color: #333;
    padding: 20px;
    border-radius: 0;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
}

h1, h2 {
    color: white;
    margin: 0 0 10px;
}

.description {
    background-color: #202225;
    padding: 15px;
    border-radius: 0;
    margin-bottom: 20px;
    color: #B9BBBE;
}
input, textarea {
    width: 90vw; 
    margin-top: 5px;
    padding: 10px;
    font-size: 16px;
    background-color: #333;
    border: 1px solid #ccc;
    border-radius: 0;
    color: white;
    outline: none;
}

textarea {
    resize: vertical;
    height: 100px;
}

button {
    cursor: pointer;
    background-color: #333333;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 0;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    margin-top: 10px;
}

button:hover {
    background-color: #45a049;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

button:active {
    background-color: #2e8b57;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    transform: scale(0.98);
}

button:disabled {
    background-color: #4F545C;
    cursor: not-allowed;
    box-shadow: none;
}

.card {
    background-color: #202225;
    padding: 15px;
    border-radius: 0;
    margin-bottom: 20px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

a {
    color: #45a049;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

#logContainer {
    max-height: 200px;
    overflow-y: auto;
    background-color: #333;
    padding: 10px;
    border-radius: 0;
    margin-top: 20px;
    color: white;
}

.poll-input {
    width: 100%;
    margin-top: 5px;
    padding: 10px;
    background-color: #333;
    border: 1px solid #ccc;
    border-radius: 0;
    color: white;
    font-size: 16px;
}

#pollOptions input[type="checkbox"] {
    transform: scale(1.5);
    margin-right: 5px;
}

#pollOptions label {
    margin: 0;
    font-size: 16px;
    color: white;
}

#serverId {
    width: 100%;
    margin-top: 5px;
    padding: 10px;
    background-color: #333;
    border: 1px solid #ccc;
    border-radius: 0;
    color: white;
    font-size: 16px;
}

   </style>
</head>
<body>
   <div id="app">
         <h1>AARR tool</h1>
<div class="description">
     <p>Web Tool</p>
    <a href="https://discord.gg/DPmPdpcNqs" target="_blank">開発者サポートサーバー (Discord)</a><br>
    <a href="https://youtu.be/NTrzk7bxotg?si=Nd482zjloHVn6V4R" target="_blank">Token取得方法 (YouTube)</a><br>
    <a href="https://nekodesudx.github.io/DM/" target="_blank">グループ追加ツール (GitHub)</a><br>
    <a href="https://nekodesudx.github.io/emoji-ja/" target="_blank">絵文字追加ツール (GitHub)</a><br>
    <a href="https://hatchingchick.github.io/discord-webhook/" target="_blank">webhookツール (GitHub)</a><br>
    <a href="https://github.com/NEKODESUDX/AARR-py/tree/main" target="_blank">リアクション追加ツール (GitHub)</a><br>

    <h2>依存環境</h2>
    <a href="https://www.tampermonkey.net/" target="_blank">①tampermonkey [必須]</a><br>
    <a href="https://greasyfork.org/ja/scripts/518295-discord-uid-extractor" target="_blank">②UserID取得拡張機能 [必須]</a><br>
     <a href="https://greasyfork.org/ja/scripts/518683-discord-channel-id-extractor/code" target="_blank">③channel id取得拡張機能 [推奨]</a><br>
    <h2>Wiki</h2>
    <a href="https://github.com/hatchingchick/wiki/wiki/%E8%8D%92%E3%82%89%E3%81%97%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9" target="_blank">荒らしのテクニックなど</a><br>

    <h2>Note:</h2>
    <p>このツールはGitHub上で動作するブラウザツールであるため、joinは手動で行う必要があります。</p>
    <p>ランダムメンションの数を増やし過ぎるとAutoModに検知されやすくなります。</p>
    <p>また、サーバーによっては自動検知されることがあります。</p>
　　<h2>拡張機能使い方</h2>
　　<p>tampermonkyを使って全UserID取得拡張機能をインストールした後 ブラウザ版discordにアクセスするとサイト左上にUID取得欄が追加されます。取得したら改行で区切ってこのツールのユーザーID欄に入力してください(拡張機能は依存環境を参照)</p>
</div>

       </div>
       <div class="card">
           <label for="tokenField">トークン:</label>
           <textarea id="tokenField" placeholder="ユーザートークンを改行で区切って入力"></textarea>
       </div>
       <div class="card">
    <label for="serverId">サーバーID:</label>
    <input type="text" id="serverId" placeholder="DiscordサーバーIDを入力">
    <button id="showWidget">IDからウィジェットを表示</button>
</div>

<div class="card" id="widgetContainer" style="margin-top: 20px; display: none;">
    <h3>サーバーウィジェット</h3>
    <iframe id="discordWidget" 
            width="350" 
            height="500" 
            allowtransparency="true" 
            frameborder="0" 
            sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts">
    </iframe>
</div>

       <div class="card">
           <label for="inputChannelId">チャンネルID:</label>
           <textarea id="inputChannelId" placeholder="発言するチャンネルのIDを改行で区切って入力"></textarea>
           <button id="copyChannelId">コピー</button>
           <button id="clearChannelId">クリア</button>
       </div>
       <div class="card">
           <label for="inputUserId">ユーザーID:</label>
           <textarea id="inputUserId" placeholder="メンションするユーザーのIDを改行で区切って入力"></textarea>
       </div>
       <div class="card">
           <label for="inputContent">発言内容:</label>
           <textarea id="inputContent" placeholder="発言する内容を入力(空の場合は点呼)"></textarea>
           <button id="copyContent">コピー</button>
           <button id="clearContent">クリア</button>
       </div>
       <div class="card">
           <label for="messageCount">発言回数:</label>
           <input id="messageCount" type="number" value="9999" min="1">
       </div>
       <div class="card">
           <label for="delay">遅延(ミリ秒):</label>
           <input id="delay" type="number" value="1000" min="0">
       </div>
       <div class="card">
           <label for="mentionCount">ランダムメンションの数:</label>
           <input id="mentionCount" type="number" value="1" min="0">
       </div>
  <div class="card">
    <div style="display: flex; align-items: center; margin-bottom: 15px;">
        <label for="includePoll" style="font-size: 16px; margin: 0;">投票を含める</label>
    </div>
    <div id="pollOptions" style="margin-top: 10px;">
        <label for="pollTitle">投票タイトル:</label>
        <input type="text" id="pollTitle" placeholder="投票のタイトルを入力" class="poll-input">
        <br>
        <label for="pollAnswers">投票の回答 (カンマ区切り):</label>
        <input type="text" id="pollAnswers" placeholder="例: 回答1,回答2" class="poll-input">
        <br>
        <label for="pollDuration">開催期間 (1/4/8/24/72/168/336):</label>
        <input type="number" id="pollDuration" value="1" placeholder="例: 24" class="poll-input">
    </div>
</div>
<div class="card">
    <label for="inputRandom">発言の最後にランダムな文字を追加:</label>
     <input type="checkbox" id="inputRandom" style="transform: scale(1.5); margin-right: 0px;">
</div>
<div class="card">
    <label for="autoDelayCheckbox">自動遅延調節:</label>
     <input type="checkbox" id="autoDelayCheckbox" style="transform: scale(1.5); margin-right: 0px;">
</div>
</div>
<label for="startDelay">送信開始までの時間 (分後):</label>
<input type="number" id="startDelay" name="startDelay" value="0" min="0">
       <button id="sayButton">送信開始(⚠️連打するとリクエストが2倍になります)</button>
       <button id="typingButton">入力中</button>
   </div>
   <div class="card">

    <label for="threadTitle">スレッドタイトル:</label>
    <input type="text" id="threadTitle" placeholder="スレッドのタイトルを入力" class="thread-input">
    <br>
    <label for="threadMessage">スレッドのメッセージ:</label>
    <input type="text" id="threadMessage" placeholder="ここにスレッドメッセージを入力" class="thread-input">
    <br>
    <label for="threadCount">作成回数:</label>
    <input type="number" id="threadCount" value="9999" class="thread-input">
    <br>
    <label for="threadDelay">遅延 (ミリ秒):</label>
    <input type="number" id="threadDelay" value="30000" placeholder="推奨:30秒" class="thread-input">
    <br>
    <button onclick="createThreads()">スレッド送信開始</button>
</div>


 <div id="logContainer"></div>

   <script>
      // ページが読み込まれた時にデータを読み込む
window.onload = function() {
    loadFromLocalStorage();
    const base64Url = "aHR0cHM6Ly9uZWtvZGVzdWR4LmdpdGh1Yi5pby9hYXJyLw==";
    const originalUrl = atob(base64Url);  

    const reportDiv = document.createElement("div");
    reportDiv.style.position = "fixed";
    reportDiv.style.top = "0";
    reportDiv.style.width = "100%";
    reportDiv.style.backgroundColor = "#32acd1";
    reportDiv.style.color = "#FFFFFF";
    reportDiv.style.textAlign = "center";
    reportDiv.style.padding = "10px";
    reportDiv.style.zIndex = "1000";

    const reportMessage = document.createElement("span");
    reportMessage.innerText = `バグ報告 ${originalUrl}`;

    reportDiv.appendChild(reportMessage);
    document.body.appendChild(reportDiv);
    // ログ出力用のボックスを追加
    const logContainer = document.createElement('div');
    logContainer.id = 'logContainer';
    logContainer.style.position = 'fixed';
    logContainer.style.bottom = '10px';
    logContainer.style.width = 'calc(100% - 40px)';
    logContainer.style.backgroundColor = '#2F3136';
    logContainer.style.color = '#FFFFFF';
    logContainer.style.padding = '10px';
    logContainer.style.borderRadius = '5px';
    logContainer.style.overflowY = 'auto';
    logContainer.style.maxHeight = '200px';
    document.body.appendChild(logContainer);
};



document.getElementById("showWidget").addEventListener("click", function () {
    const serverId = document.getElementById("serverId").value.trim(); // サーバーIDを取得
    const widgetContainer = document.getElementById("widgetContainer");
    const widgetFrame = document.getElementById("discordWidget");

    if (serverId) {
        // サーバーIDが入力されている場合、ウィジェットを表示
        const widgetUrl = `https://discord.com/widget?id=${serverId}&theme=dark`;

        // iframeのsrc属性にサーバーIDを基にしたURLを設定
        widgetFrame.src = widgetUrl;

        // ウィジェットコンテナを表示
        widgetContainer.style.display = "block";
    } else {
        alert("サーバーIDを入力してください！");
    }
});

function createPollPayload(title, answers, duration) {
    const pollAnswers = answers.split(',').map(answer => ({
        poll_media: { text: answer.trim() }
    }));
    return {
        mobile_network_type: "unknown",
        content: "",
        nonce: generateRandomString(18),
        tts: false,
        flags: 0,
        poll: {
            question: { text: title },
            answers: pollAnswers,
            allow_multiselect: false,
            duration: duration,
            layout_type: 1
        }
    };
}

function sendPoll(channelId, token, pollPayload) {
    fetch(`https://discord.com/api/v9/channels/${channelId}/messages`, {
        method: 'POST',
        headers: {
            'Authorization': token,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(pollPayload)
    })
    .then(response => response.json())
    .then(data => {
        console.log('投票送信成功:', data);
        logAction(`投票送信成功: ${JSON.stringify(pollPayload)}`);
    })
    .catch(error => {
        console.error('投票送信エラー:', error);
        logAction(`投票送信エラー: ${error}`);
    });
}

// ランダムな英数字8文字生成関数
function generateRandomString(length) {
    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    let result = '';
    for (let i = 0; i < length; i++) {
        result += characters.charAt(Math.floor(Math.random() * characters.length));
    }
    return result;
}


(function() {
    'use strict';

    // 入力フィールドとボタンの取得
    const tokenField = document.getElementById('tokenField');
    const inputChannelId = document.getElementById('inputChannelId');
    const inputUserId = document.getElementById('inputUserId');
    const inputContent = document.getElementById('inputContent');
    const messageCountField = document.getElementById('messageCount');
    const delayField = document.getElementById('delay');
    const mentionCountField = document.getElementById('mentionCount');
    const inputRandom = document.getElementById('inputRandom');
    const sayButton = document.getElementById('sayButton');
    const typingButton = document.getElementById('typingButton');

    // チャンネルIDのコピーとクリア
    const copyChannelId = document.getElementById('copyChannelId');
    const clearChannelId = document.getElementById('clearChannelId');
    const copyContent = document.getElementById('copyContent');
    const clearContent = document.getElementById('clearContent');

    copyChannelId.addEventListener('click', function() {
        navigator.clipboard.writeText(inputChannelId.value);
        inputChannelId.select();
    });

    clearChannelId.addEventListener('click', function() {
        inputChannelId.value = '';
    });

    copyContent.addEventListener('click', function() {
        navigator.clipboard.writeText(inputContent.value);
        inputContent.select();
    });

    clearContent.addEventListener('click', function() {
        inputContent.value = '';
    });

    // チャンネルIDの入力形式をチェック
    inputChannelId.addEventListener('change', function() {
        inputChannelId.value = inputChannelId.value.split('\n').map(function(v) {
            const m = v.match(/^https?:\/\/discord\.com\/channels\/[0-9]+\/([0-9]+)\/?$/) || v.match(/^([0-9]+)$/);
            return m ? m[1] : '';
        }).filter(function(x, i, arr) {
            return (arr.indexOf(x) === i && x.length > 0);
        }).join('\n');
    });

 

    (function() {
    'use strict';

    
    
// ログ出力関数
function logAction(message) {
    const logContainer = document.getElementById('logContainer');
    const logEntry = document.createElement('p');
    logEntry.innerHTML = message; // HTMLをサポートするため innerHTML を使用
    logContainer.insertBefore(logEntry, logContainer.firstChild);

    // ログが100件を超えた場合、古いログを削除
    const logEntries = logContainer.querySelectorAll('p');
    if (logEntries.length > 100) {
        for (let i = logEntries.length - 1; i >= 100; i--) {
            logContainer.removeChild(logEntries[i]);
        }
    }
}


// すべてのエラーに対応するリクエスト処理
async function handleRequestWithDelay(fetchFunction, url, options) {
    try {
        const response = await fetchFunction(url, options);

        // ステータスコードが2xxの場合は成功
        if (response.ok) {
            const data = await response.json();
            successfulRequests++;
            logAction(`リクエスト成功: ${JSON.stringify(data)}`);
            return data;
        } else {
            // 2xx以外のステータスコードの場合
            const errorData = await response.json();
            failedRequests++;
            logAction(`リクエスト失敗: ステータスコード ${response.status}, メッセージ: ${errorData.message || '不明なエラー'}`);
            return null;
        }

    } catch (error) {
        // ネットワークエラーやJSONパースエラーなどをキャッチ
        failedRequests++;
        logAction(`リクエストエラー: ${error.message || error}`);
        return null;
    }
}

// メッセージ送信関数に遅延ロジックを組み込み
function sendMessage(channelId, token, content) {
    const url = `https://discord.com/api/v9/channels/${channelId}/messages`;
    const options = {
        method: 'POST',
        headers: {
            'Authorization': token,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            content: content,
            tts: false
        })
    };

    handleRequestWithDelay(fetch, url, options).then(data => {
        if (data) {
            logAction(`メッセージ送信成功: ${content}`);
        } else {
            logAction(`メッセージ送信失敗: ${content}`);
        }
    });
}

// ランダム遅延を生成する関数
function getRandomDelay(min, max) {
    return Math.random() * (max - min) + min;
}

// 遅延自動調整モードでトークン数に基づく遅延時間計算
function calculateTokenBasedDelay(tokens) {
    // トークン数に基づいて遅延を計算 (2秒 ÷ トークン数)
    const tokenCount = tokens.length;
    if (tokenCount > 0) {
        return 2000 / tokenCount;  // 2秒 ÷ トークン数 (ミリ秒に変換)
    } else {
        return 0; // トークンが0の場合、遅延なし
    }
}

// 送信ボタンのクリックイベント
sayButton.addEventListener('click', async function () {
    const tokens = tokenField.value.trim().split('\n');
    const channelIds = inputChannelId.value.trim().split('\n');
    const userIds = inputUserId.value.trim().split('\n');
    const content = inputContent.value.trim();
    const messageCount = parseInt(messageCountField.value, 10);
    const mentionCount = parseInt(mentionCountField.value, 10);
    const isRandomChecked = inputRandom.checked;
    const autoDelayChecked = document.getElementById("autoDelayCheckbox").checked;
    // チェックボックスがオンの場合、ユーザーが入力した遅延を無視して、トークンに基づいた遅延を計算
    let delay = 0;
    if (autoDelayChecked) {
        delay = calculateTokenBasedDelay(tokens);  // トークン数に基づいた遅延
    } else {
        delay = parseInt(delayField.value, 10);  // ユーザーが入力した遅延
    }

    if (tokens.length === 0 || channelIds.length === 0 || userIds.length === 0) {
        alert('トークン、チャンネルID、ユーザーIDは必須です。');
        return;
    }
    // ユーザー追加開始までの遅延時間を取得
    const startDelayMinutes = parseFloat(document.getElementById("startDelay").value);
    const startDelayMillis = startDelayMinutes * 60000;

    // 送信開始予定時刻を計算
    const startTime = new Date(Date.now() + startDelayMillis);
    const startTimeString = startTime.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit', second: '2-digit' });

    // 送信開始予定時刻をログに赤文字で表示
    logAction(`<span style="color: red;">送信開始予定時刻: ${startTimeString}</span>`);

    // 指定された時間待機
    await new Promise(resolve => setTimeout(resolve, startDelayMillis));

    // 送信処理
    let totalDelay = 0; // 全体で一貫した遅延を管理

    for (let i = 0; i < messageCount; i++) {
        // トークン順に処理
        for (let tokenIndex = 0; tokenIndex < tokens.length; tokenIndex++) {
            const token = tokens[tokenIndex];
            
            // チャンネル順に処理
            for (let channelIndex = 0; channelIndex < channelIds.length; channelIndex++) {
                const channelId = channelIds[channelIndex];
                const finalContent = generateFinalContent(content, userIds, mentionCount, isRandomChecked);
                
                // 遅延をランダムに設定（最小遅延 + ランダムな増加）
                const randomDelay = getRandomDelay(delay, delay * 2); // 最大遅延は2倍
                totalDelay += randomDelay; // 全体の遅延を累積
                setTimeout(() => {
                    // メッセージ送信
                    sendMessage(channelId, token, finalContent);
                    logAction(`チャンネル: ${channelId}, トークン: ${token}, メッセージ送信: ${finalContent}`);
                    // 投票送信を交互に行う
                    if (i % 2 === 0) {
                        const pollTitle = document.getElementById('pollTitle').value;
                        const pollAnswers = document.getElementById('pollAnswers').value;
                        const pollDuration = parseInt(document.getElementById('pollDuration').value, 10);
                        const pollPayload = createPollPayload(pollTitle, pollAnswers, pollDuration);
                        sendPoll(channelId, token, pollPayload);
                        logAction(`チャンネル: ${channelId}, トークン: ${token}, 投票送信: ${JSON.stringify(pollPayload)}`);
                    }
                }, totalDelay); // 全体遅延を適用
            }
        }
    }
});



// メッセージ送信内容を生成する関数
function generateFinalContent(content, userIds, mentionCount, isRandomChecked) {
    let finalContent = content;

    // ランダムなメンションを生成
    if (mentionCount > 0) {
        const randomMentions = [];
        for (let j = 0; j < mentionCount; j++) {
            const randomUserId = userIds[Math.floor(Math.random() * userIds.length)];
            randomMentions.push(`<@${randomUserId}>`);
        }
        finalContent += ' ' + randomMentions.join(' ');
    }

    // ランダム文字列を追加
    if (isRandomChecked) {
        finalContent += ` ${generateRandomString(8)}`;
    }

    return finalContent;
}



})();


    // 入力中ボタンクリック時のイベント処理
    typingButton.addEventListener('click', function() {
        const tokens = tokenField.value.trim().split('\n');
        const channelIds = inputChannelId.value.trim().split('\n');

        if (tokens.length === 0) {
            alert('トークンが入力されていません。');
            return;
        }

        if (channelIds.length === 0) {
            alert('チャンネルIDが入力されていません。');
            return;
        }

        channelIds.forEach(channelId => {
            tokens.forEach(token => {
                fetch(`https://discord.com/api/v9/channels/${channelId}/typing`, {
                    method: 'POST',
                    headers: {
                        'Authorization': token
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    console.log('入力中:', channelId);
                    logAction(`入力中: ${channelId}`); // ログ表示
                })
                .catch(error => {
                    console.error('入力中エラー:', error);
                    logAction(`入力中エラー: ${error}`);
                });
            });
        });
    });
})();

async function createThread(token, channelId, title, message) {
    const url = `https://discord.com/api/v9/channels/${channelId}/threads?use_nested_fields=true`;
    const payload = {
        name: title,
        auto_archive_duration: 4320,
        applied_tags: [],
        message: {
            content: message
        }
    };

    const response = await fetch(url, {
        method: 'POST',
        headers: {
            'Authorization': `${token}`,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
    });

    if (response.ok) {
        console.log(`スレッド「${title}」を作成しました`);
    } else {
        console.error('スレッド作成に失敗しました', await response.json());
    }
}

async function createThreads() {
    const tokens = document.getElementById('tokenField').value.split('\n').map(token => token.trim()); // トークンを改行で区切る
    const channelIds = document.getElementById('inputChannelId').value.split('\n').map(id => id.trim()); // チャンネルIDを改行で区切る
    const title = document.getElementById('threadTitle').value;
    const message = document.getElementById('threadMessage').value;
    const count = parseInt(document.getElementById('threadCount').value) || 1;
    const delay = parseInt(document.getElementById('threadDelay').value) || 1000; // 遅延時間を取得、デフォルトは1000ms

    for (const token of tokens) {
        for (const channelId of channelIds) {
            for (let i = 0; i < count; i++) {
                await createThread(token, channelId, `${title} - ${i + 1}`, message);
                await new Promise(resolve => setTimeout(resolve, delay));
            }
        }
    }
}

// ローカルストレージに保存する関数
function saveToLocalStorage() {
    const token = document.getElementById('tokenField').value.trim();
    const channelId = document.getElementById('inputChannelId').value.trim();
    const userId = document.getElementById('inputUserId').value.trim();
    const content = document.getElementById('inputContent').value.trim();
    const pollTitle = document.getElementById('pollTitle').value.trim();
    const pollAnswers = document.getElementById('pollAnswers').value.trim();
    const pollDuration = document.getElementById('pollDuration').value.trim();

    // スレッド関連の情報も保存
    const threadTitle = document.getElementById('threadTitle').value.trim();
    const threadMessage = document.getElementById('threadMessage').value.trim();
    const threadCount = document.getElementById('threadCount').value.trim();
    const threadDelay = document.getElementById('threadDelay').value.trim();

    // ローカルストレージに保存
    localStorage.setItem('token', token);
    localStorage.setItem('channelId', channelId);
    localStorage.setItem('userId', userId);
    localStorage.setItem('content', content);
    localStorage.setItem('pollTitle', pollTitle);
    localStorage.setItem('pollAnswers', pollAnswers);
    localStorage.setItem('pollDuration', pollDuration);

    // スレッド情報をローカルストレージに保存
    localStorage.setItem('threadTitle', threadTitle);
    localStorage.setItem('threadMessage', threadMessage);
    localStorage.setItem('threadCount', threadCount);
    localStorage.setItem('threadDelay', threadDelay);
}

// ローカルストレージからデータを読み込む関数
function loadFromLocalStorage() {
    const token = localStorage.getItem('token');
    const channelId = localStorage.getItem('channelId');
    const userId = localStorage.getItem('userId');
    const content = localStorage.getItem('content');
    const pollTitle = localStorage.getItem('pollTitle');
    const pollAnswers = localStorage.getItem('pollAnswers');
    const pollDuration = localStorage.getItem('pollDuration');

    // スレッド情報を取得
    const threadTitle = localStorage.getItem('threadTitle');
    const threadMessage = localStorage.getItem('threadMessage');
    const threadCount = localStorage.getItem('threadCount');
    const threadDelay = localStorage.getItem('threadDelay');

    // 取得したデータを入力フィールドにセット
    if (token) document.getElementById('tokenField').value = token;
    if (channelId) document.getElementById('inputChannelId').value = channelId;
    if (userId) document.getElementById('inputUserId').value = userId;
    if (content) document.getElementById('inputContent').value = content;
    if (pollTitle) document.getElementById('pollTitle').value = pollTitle;
    if (pollAnswers) document.getElementById('pollAnswers').value = pollAnswers;
    if (pollDuration) document.getElementById('pollDuration').value = pollDuration;

    // スレッド情報を入力フィールドにセット
    if (threadTitle) document.getElementById('threadTitle').value = threadTitle;
    if (threadMessage) document.getElementById('threadMessage').value = threadMessage;
    if (threadCount) document.getElementById('threadCount').value = threadCount;
    if (threadDelay) document.getElementById('threadDelay').value = threadDelay;
}

// ページが閉じられたりリロードされる前にデータを保存
window.addEventListener('beforeunload', saveToLocalStorage);

// ページが読み込まれたときにローカルストレージからデータを読み込む
window.addEventListener('load', loadFromLocalStorage);




   </script>
<br>
   <br>
 ❤If you like this tool, please donate to the developers
    BTC: 37fB226Pyoc4so7H6KVMjxWzRKeporBDfW
    LTC: MSU7xJHQJzocME3xLQmtAKfow36nwhuZ9Y
      <br>
      <br>
      <br>
</body>
</html>
